{% extends 'app/base.html' %}
{% load static staticfiles %}

{% block title %}
    微信小助手-日志
{% endblock %}

{% block content %}
    <div id="log_box"></div>
{% endblock %}

{% block script %}
    <script>
        $(function(){
            var log_box = $('div#log_box');
            var client_id = null;
            var channel = 'log';
            var test_url = '/app/socket/test';
            var close_url = '/app/socket/close';
            var open_url = '/app/socket/open';
            function show_message(message){
                log_box.prepend('<p>' + message.data + '</p>');
            }
            open_connection(test_url, open_url, client_id, channel, show_message);
            window.onbeforeunload = function(){
                alert('关闭');
                close_connection(close_url, client_id, channel);
            };
        });
    </script>
{% endblock %}

{% block style %}
    <style>
        div#log_box{
            position: relative;
            height: 85%;
            width: 85%;
            left: 7.5%;
            top: 7.5%;

            text-align: left;
            color: #f6f9f6;
            font: 16px;
            word-wrap:break-word;
            word-break:break-all;
            overflow-y: scroll;
            overflow-x: hidden;

            background-color: rgba(0,0,0, .65);
            border: 5px groove black;

            /*圆角*/
            -moz-border-radius: 10px;
            border-radius: 10px;
        }
        p{
            padding: 5px 10px;
            padding-bottom: 0px; 
        }
    </style>
{% endblock %}